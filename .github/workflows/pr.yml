name: Quality Assurance

on: [pull_request, workflow_call]
jobs:
  quality-assurance:
    runs-on: ubuntu-latest

    container:
      image: python:3.12-slim

    env:
      DATABASE_NAME: olf_db
      DATABASE_USERNAME: olf_user
      DATABASE_PASSWORD: ${{ secrets.CI_DATABASE_PASSWORD }}
      DATABASE_HOSTNAME: db
      DATABASE_PORT: 5432

      DROPBOX_APP_KEY: ${{ secrets.DROPBOX_APP_KEY }}
      DROPBOX_APP_SECRET: ${{ secrets.DROPBOX_APP_SECRET }}
      OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}

      DJANGO_SETTINGS_MODULE: backend.settings
      CI: "true"

    services:
      db:
        image: postgres:17-alpine
        env:
          POSTGRES_DB: olf_db
          POSTGRES_USER: olf_user
          POSTGRES_PASSWORD: ${{ secrets.CI_DATABASE_PASSWORD }}
